# scan-repo: Проектная Сводка и Руководство по Развертыванию

Данный документ представляет собой подробную сводку для проекта `scan-repo`. На основе предоставленного исходного кода (`main.py`) и анализа его функционала, мы предоставляем точное описание архитектуры, требований и процесса развертывания этого инструмента для документирования репозиториев.

---

## 1. Обзор Проекта

`scan-repo` — это консольное Python-приложение, предназначенное для **автоматической генерации подробных README.md файлов для GitHub-репозиториев**. Инструмент позволяет клонировать удаленные репозитории (или работать с локальными), сканировать их структуру и содержимое файлов, а затем использовать **локальную большую языковую модель (LLM) через Ollama** для анализа кода и генерации содержательных разделов README, таких как описание проекта, его функционал, используемые технологии, инструкции по установке и примеры использования.

### 1.1. Ключевые Архитектурные Решения и Преимущества

* **Автономный Анализ Репозиториев:** Приложение может клонировать Git-репозитории из удаленных источников (например, GitHub) во временную директорию или работать с уже существующими локальными репозиториями.
* **Локальная LLM-Обработка:** Все сложные аналитические задачи, такие как понимание назначения файлов и генерация текстового контента для README, выполняются локально с использованием Ollama. Это обеспечивает:
    * **Конфиденциальность данных:** Содержимое вашего кода не отправляется во внешние облачные сервисы.
    * **Независимость:** Работает без постоянного подключения к интернету (после загрузки модели Ollama).
    * **Контроль:** Вы полностью контролируете используемую модель и окружение.
* **Селективное Сканирование Файлов:** Инструмент автоматически игнорирует стандартные служебные директории и файлы (например, `.git`, `node_modules`, `README.md`), фокусируясь на релевантном исходном коде и конфигурационных файлах.
* **Определение Языков Программирования:** Встроенная логика сопоставляет расширения файлов с соответствующими языками программирования, что позволяет LLM более точно анализировать контекст кода.
* **Интеграция с Git:** Используется библиотека `GitPython` для взаимодействия с репозиторием, получения информации о последнем коммите и URL удаленного репозитория.
* **Структурированный Вывод LLM:** Генерация разделов README происходит на основе **строго определенной JSON-схемы**, что гарантирует получение структурированного и предсказуемого ответа от LLM, упрощая форматирование конечного README.
* **Информативность README:** Сгенерированный README включает в себя метаданные репозитория (имя, URL), статистику по языкам, информацию о последнем коммите, а также подробные разделы, сгенерированные ИИ.
* **Управление Временными Файлами:** Предусмотрена функция очистки временных директорий, созданных для клонированных репозиториев, что поддерживает порядок в файловой системе.
* **Удобство Использования:** Предоставляет индикацию прогресса в консоли, облегчая отслеживание выполнения долгих операций.

---

## 2. Предварительные Требования к Развертыванию

Для успешного развертывания и функционирования `scan-repo` необходимо обеспечить наличие следующих системных компонентов и программного обеспечения:

1.  **Git:** Система контроля версий, необходимая для клонирования репозиториев.
2.  **Ollama (Версия 0.1.20 или выше):** Фундаментальная платформа для управления и запуска локальных LLM.
3.  **Модель `saiga` (или `llama3`):** Основная языковая модель, используемая проектом. В коде по умолчанию указана `saiga`, но также можно использовать `llama3`, как показано в примере промпта. Должна быть загружена через Ollama.
4.  **Python (Версия 3.8.x - 3.12.x):** Основной интерпретатор для выполнения логики приложения. Рекомендуется использовать поддерживаемые версии для совместимости с библиотеками.
5.  **pip (Актуальная версия):** Стандартный менеджер пакетов Python, необходимый для разрешения и установки проектных зависимостей.

---

## 3. Процесс Установки и Настройки

Следующий пошаговый план описывает процедуру развертывания `scan-repo` на целевой системе.

### 3.1. Установка Git

Git необходим для клонирования репозиториев.

* **Windows / macOS:**
    Загрузите инсталлятор с официального сайта Git: [git-scm.com/downloads](https://git-scm.com/downloads). Следуйте инструкциям мастера установки.

* **Linux (Debian/Ubuntu):**
    Откройте терминал и выполните команду:
    ```bash
    sudo apt update
    sudo apt install git
    ```

**Верификация Установки Git:**
В терминале выполните:
```bash
git --version
```
Ожидаемый вывод: номер версии Git.

### 3.2. Установка Ollama

Ollama поддерживает кроссплатформенное развертывание на macOS, Linux и Windows.

* **macOS:**
    Загрузите дистрибутив по ссылке: [ollama.com/download/mac](https://ollama.com/download/mac).
    Запустите `.dmg` инсталлятор и следуйте инструкциям мастера установки.

* **Linux:**
    Откройте терминал и выполните команду для автоматизированной установки:
    ```bash
    curl -fsSL [https://ollama.com/install.sh](https://ollama.com/install.sh) | sh
    ```

* **Windows:**
    Загрузите исполняемый файл инсталлятора с: [ollama.com/download/windows](https://ollama.com/download/windows).
    Запустите `.exe` файл и завершите установку, следуя указаниям.

**Верификация Установки Ollama:**
После завершения установки, подтвердите работоспособность Ollama, выполнив в терминале:
```bash
ollama --version
```
Ожидаемый вывод: номер версии Ollama, что подтверждает успешное развертывание службы.

### 3.3. Загрузка Модели LLM (`saiga` или `llama3`)

После успешной установки Ollama, необходимо загрузить целевую языковую модель. В коде по умолчанию используется `saiga`, но также подойдет `llama3`.

В терминале выполните команду загрузки (выберите одну из них):
```bash
ollama pull saiga
# ИЛИ
ollama pull llama3
```
Время загрузки зависит от пропускной способности вашего интернет-соединения и размера модели. Для ознакомления с полным каталогом доступных моделей посетите [ollama.com/library](https://ollama.com/library).

### 3.4. Развертывание scan-repo (Python Проект)

`scan-repo` является стандартным проектом на Python.

1.  **Клонирование Исходного Кода:**
    Убедитесь, что `git` установлен. Затем, в выбранной рабочей директории, выполните клонирование репозитория `scan-repo`:
    ```bash
    git clone [https://github.com/4elobrek9/scan-repo.git](https://github.com/4elobrek9/scan-repo.git)
    cd scan-repo
    ```

2.  **Инициализация Виртуального Окружения (Рекомендуемая Практика):**
    Для изоляции зависимостей проекта и предотвращения конфликтов с системными пакетами Python, создайте и активируйте виртуальное окружение:
    ```bash
    python -m venv venv
    ```
    * **Для Windows:**
        ```powershell
        .\venv\Scripts\activate
        ```
    * **Для macOS/Linux:**
        ```bash
        source venv/bin/activate
        ```
    *(Примечание: После активации виртуального окружения префикс `(venv)` должен появиться в вашей командной строке.)*

3.  **Установка Зависимостей Python:**
    Проект использует следующие внешние библиотеки, которые необходимо установить. Создайте файл `requirements.txt` в корневой директории проекта со следующим содержимым:
    ```
    GitPython==3.1.43
    requests==2.32.3
    ```
    Затем установите зависимости:
    ```bash
    pip install -r requirements.txt
    ```

---

## 4. Эксплуатация Системы

После успешного выполнения всех шагов установки и настройки, `scan-repo` готов к запуску.

1.  **Подтверждение Работоспособности Ollama:** Убедитесь, что служба Ollama активна в фоновом режиме (она должна быть запущена автоматически после установки или может быть запущена вручную).
2.  **Запуск Приложения:**
    Перейдите в корневую директорию проекта `scan-repo` в активном виртуальном окружении и запустите основной исполняемый скрипт `main.py`, передав ему URL репозитория или локальный путь:

    ```bash
    python main.py [https://github.com/4elobrek9/ai_helper](https://github.com/4elobrek9/ai_helper) # Пример с удаленным репозиторием
    # ИЛИ
    python main.py /путь/к/вашему/локальному/репозиторию # Пример с локальным репозиторием
    ```

    Приложение начнет процесс клонирования (если указан URL), сканирования, анализа файлов с помощью Ollama и генерации `README.md`. Прогресс будет отображаться в консоли. Сгенерированный `README.md` будет сохранен в той же директории, откуда был запущен скрипт.

---

## 5. Руководство по Разработке и Вкладу

Проект `scan-repo` приветствует вклад сообщества. Для участия в разработке следуйте стандартному рабочему процессу Git/GitHub:

1.  **Форкните** основной репозиторий проекта.
2.  **Создайте новую ветку** для ваших изменений, используя осмысленное имя (например, `feature/add-new-language`, `bugfix/fix-ollama-parsing`).
    `git checkout -b feature/новая-функциональность`
3.  **Реализуйте** изменения и **зафиксируйте** их, используя атомарные и описательные сообщения коммитов, соответствующие конвенциям (например, Conventional Commits).
    `git commit -m "feat: Добавить функцию X для обработки Y"`
4.  **Отправьте** вашу ветку в ваш форк.
    `git push origin feature/новая-функциональность`
5.  **Создайте Pull Request (PR)** в основной репозиторий, подробно описывая внесенные изменения, их обоснование и результаты тестирования. Обеспечьте, что ваш код соответствует PEP 8 и прошёл все автоматизированные тесты, если таковые имеются.

### 5.1. Потенциальные Области для Улучшений

* **Конфигурация:** Внедрение файла конфигурации (например, YAML, JSON) для таких параметров, как `ollama_url`, `model_name`, списки игнорируемых директорий и файлов, а также пути для сохранения README.
* **Масштабируемость Анализа:** Для очень больших репозиториев рассмотреть возможность более интеллектуальной стратегии разделения файлов на части (chunking) или приоритезации анализа.
* **Поддержка Других Git-Хостингов:** Расширение функционала для работы с репозиториями на других платформах (GitLab, Bitbucket) помимо GitHub.
* **Кэширование LLM-Ответов:** Реализация кэширования для LLM-ответов по файлам, чтобы избежать повторного анализа одних и тех же файлов при многократных запусках.
* **Интерфейс Пользователя:** Разработка графического интерфейса (GUI) или более интерактивного консольного интерфейса для упрощения взаимодействия.
* **Тестирование:** Разработка юнит-тестов и интеграционных тестов для обеспечения стабильности и корректности работы всех модулей.
* **Расширение Языков Программирования:** Добавление большего количества расширений файлов и соответствующих им языков в `self.file_extensions`.
* **Кастомизация README:** Предоставление пользователю возможности кастомизировать шаблон README или выбирать из нескольких готовых шаблонов.

